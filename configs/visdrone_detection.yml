task: detection

num_classes: 10 # VisDrone 类别数
remap_mscoco_category: False

train_dataloader:
  type: DataLoader
  dataset:
    type: CocoDetection
    # 指向你的训练集图片
    img_folder: ./datasets/VisDrone2019-DET-train/images
    # 指向你的 COCO 格式标注文件 (必须是 JSON)
    ann_file: ./datasets/VisDrone2019-DET-train/train.json
    return_masks: False
    transforms:
      type: Compose
      ops: ~
  shuffle: True
  batch_size: 4 # 根据显存调整
  num_workers: 4
  drop_last: True
  # [关键修复] 必须指定 collate_fn，否则无法处理不同数量的检测框
  collate_fn: default_collate_fn

val_dataloader:
  type: DataLoader
  dataset:
    type: CocoDetection
    img_folder: ./datasets/VisDrone2019-DET-val/images
    ann_file: ./datasets/VisDrone2019-DET-val/val.json
    return_masks: False
    transforms:
      type: Compose
      ops: ~
  shuffle: False
  batch_size: 4
  num_workers: 4
  drop_last: False
  # [关键修复] 验证集也要加
  collate_fn: default_collate_fn